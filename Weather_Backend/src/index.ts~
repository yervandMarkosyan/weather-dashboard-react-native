import express from 'express';
import type { Request, Response } from 'express';
import { MongoClient } from 'mongodb';

const app = express();
const PORT = process.env.PORT || 3000; 

app.use(express.json()); 

const uri = 'mongodb://localhost:27017'; 
const client = new MongoClient(uri); 
const dbName = 'weather'; 

app.get('/api/city/:name', async (req, res) => {
	try {
		await client.connect(); 
		const db = client.db(dbName); 
		const cities = db.collection('cities'); 
		const city = await cities.findOne({ name: req.params.name }); 
		res.json(city || { error: 'City not found' }); 
	} catch (err) { 
		res.status(500).send('Server error'); 
	} finally { 
		await client.close(); 
	} 
}); 
	app.listen(PORT, () => console.log(`Server is running on port ${PORT}`));
